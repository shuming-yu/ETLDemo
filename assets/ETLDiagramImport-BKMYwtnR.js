import{u as ae,Q as ne,a as ie}from"./use-quasar-D-hVknpX.js";import{g as X,r as V,a as v,ay as oe,a2 as J,az as se,h as D,c as ue,aA as re,a5 as ce,aB as de,aC as fe,aD as me,aE as ve,aF as H,ab as pe,aG as ge,aH as _e,F as Te,H as be,s as Ne,aI as ye,K as Se,L,M as I,N as c,Z as Fe,_ as Y,W as Ie,U as Ve,T as y,Q as q,O as j,P as $,ae as Ce,X as he,aJ as Oe,Y as De,ap as Pe,ac as Re}from"./index-weJWtW1h.js";import{b as Ae,a as W}from"./QTable-jeqM6Mmq.js";import{n as xe}from"./PopupDialog-CTxAAtoL.js";import{u as Ee}from"./ETLRelation.jsonvuetypei18nindex0srctruelang-D4kxEK6b.js";import{b as K}from"./ETLInfo.jsonvuetypei18nindex0srctruelang-4JF1Bjs0.js";import{_ as Ue}from"./plugin-vueexport-helper-DlAUqK2U.js";function E(t,d,f,T){const i=[];return t.forEach(u=>{T(u)===!0?i.push(u):d.push({failedPropValidation:f,file:u})}),i}function M(t){t?.dataTransfer&&(t.dataTransfer.dropEffect="copy"),J(t)}const ke={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},ze=["rejected"];function je({editable:t,dnd:d,getFileInput:f,addFilesToQueue:T}){const{props:i,emit:u,proxy:p}=X(),b=V(null),C=v(()=>i.accept!==void 0?i.accept.split(",").map(e=>(e=e.trim(),e==="*"?"*/":(e.endsWith("/*")&&(e=e.slice(0,e.length-1)),e.toUpperCase()))):null),h=v(()=>parseInt(i.maxFiles,10)),O=v(()=>parseInt(i.maxTotalSize,10));function S(e){if(t.value)if(e!==Object(e)&&(e={target:null}),e.target?.matches('input[type="file"]')===!0)e.clientX===0&&e.clientY===0&&oe(e);else{const s=f();s!==e.target&&s?.click(e)}}function P(e){t.value&&e&&T(null,e)}function R(e,s,N,k){let a=Array.from(s||e.target.files);const g=[],F=()=>{g.length!==0&&u("rejected",g)};if(i.accept!==void 0&&C.value.indexOf("*/")===-1&&(a=E(a,g,"accept",n=>C.value.some(r=>n.type.toUpperCase().startsWith(r)||n.name.toUpperCase().endsWith(r))),a.length===0))return F();if(i.maxFileSize!==void 0){const n=parseInt(i.maxFileSize,10);if(a=E(a,g,"max-file-size",r=>r.size<=n),a.length===0)return F()}if(i.multiple!==!0&&a.length!==0&&(a=[a[0]]),a.forEach(n=>{n.__key=n.webkitRelativePath+n.lastModified+n.name+n.size}),k===!0){const n=N.map(r=>r.__key);a=E(a,g,"duplicate",r=>n.includes(r.__key)===!1)}if(a.length===0)return F();if(i.maxTotalSize!==void 0){let n=k===!0?N.reduce((r,B)=>r+B.size,0):0;if(a=E(a,g,"max-total-size",r=>(n+=r.size,n<=O.value)),a.length===0)return F()}if(typeof i.filter=="function"){const n=i.filter(a);a=E(a,g,"filter",r=>n.includes(r))}if(i.maxFiles!==void 0){let n=k===!0?N.length:0;if(a=E(a,g,"max-files",()=>(n++,n<=h.value)),a.length===0)return F()}if(F(),a.length!==0)return a}function U(e){M(e),d.value!==!0&&(d.value=!0)}function o(e){J(e),(e.relatedTarget!==null||se.is.safari!==!0?e.relatedTarget!==b.value:document.elementsFromPoint(e.clientX,e.clientY).includes(b.value)===!1)===!0&&(d.value=!1)}function A(e){M(e);const s=e.dataTransfer.files;s.length!==0&&T(null,s),d.value=!1}function x(e){if(d.value===!0)return D("div",{ref:b,class:`q-${e}__dnd absolute-full`,onDragenter:M,onDragover:M,onDragleave:o,onDrop:A})}return Object.assign(p,{pickFiles:S,addFiles:P}),{pickFiles:S,addFiles:P,onDragover:U,onDragleave:o,processFiles:R,getDndNode:x,maxFilesNumber:h,maxTotalSizeNumber:O}}const Me=ue({name:"QFile",inheritAttrs:!1,props:{...de,...ce,...ke,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...re,...ze],setup(t,{slots:d,emit:f,attrs:T}){const{proxy:i}=X(),u=fe(),p=V(null),b=V(!1),C=me(t),{pickFiles:h,onDragover:O,onDragleave:S,processFiles:P,getDndNode:R}=je({editable:u.editable,dnd:b,getFileInput:w,addFilesToQueue:G}),U=ve(t),o=v(()=>Object(t.modelValue)===t.modelValue?"length"in t.modelValue?Array.from(t.modelValue):[t.modelValue]:[]),A=v(()=>H(o.value)),x=v(()=>o.value.map(l=>l.name).join(", ")),e=v(()=>xe(o.value.reduce((l,m)=>l+m.size,0))),s=v(()=>({totalSize:e.value,filesNumber:o.value.length,maxFiles:t.maxFiles})),N=v(()=>({tabindex:-1,type:"file",title:"",accept:t.accept,capture:t.capture,name:C.value,...T,id:u.targetUid.value,disabled:u.editable.value!==!0})),k=v(()=>"q-file q-field--auto-height"+(b.value===!0?" q-file--dnd":"")),a=v(()=>t.multiple===!0&&t.append===!0);function g(l){const m=o.value.slice();m.splice(l,1),n(m)}function F(l){const m=o.value.indexOf(l);m!==-1&&g(m)}function n(l){f("update:modelValue",t.multiple===!0?l:l[0])}function r(l){l.keyCode===13&&_e(l)}function B(l){(l.keyCode===13||l.keyCode===32)&&h(l)}function w(){return p.value}function G(l,m){const _=P(l,m,o.value,a.value),Q=w();Q!=null&&(Q.value=""),_!==void 0&&((t.multiple===!0?t.modelValue&&_.every(le=>o.value.includes(le)):t.modelValue===_[0])||n(a.value===!0?o.value.concat(_):_))}function z(){return[D("input",{class:[t.inputClass,"q-file__filler"],style:t.inputStyle})]}function ee(){if(d.file!==void 0)return o.value.length===0?z():o.value.map((m,_)=>d.file({index:_,file:m,ref:this}));if(d.selected!==void 0)return o.value.length===0?z():d.selected({files:o.value,ref:this});if(t.useChips===!0)return o.value.length===0?z():o.value.map((m,_)=>D(Ae,{key:"file-"+_,removable:u.editable.value,dense:!0,textColor:t.color,tabindex:t.tabindex,onRemove:()=>{g(_)}},()=>D("span",{class:"ellipsis",textContent:m.name})));const l=t.displayValue!==void 0?t.displayValue:x.value;return l.length!==0?[D("div",{class:t.inputClass,style:t.inputStyle,textContent:l})]:z()}function te(){const l={ref:p,...N.value,...U.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:G};return t.multiple===!0&&(l.multiple=!0),D("input",l)}return Object.assign(u,{fieldClass:k,emitValue:n,hasValue:A,inputRef:p,innerValue:o,floatingLabel:v(()=>A.value===!0||H(t.displayValue)),computedCounter:v(()=>{if(t.counterLabel!==void 0)return t.counterLabel(s.value);const l=t.maxFiles;return`${o.value.length}${l!==void 0?" / "+l:""} (${e.value})`}),getControlChild:()=>R("file"),getControl:()=>{const l={ref:u.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:t.tabindex};return u.editable.value===!0&&Object.assign(l,{onDragover:O,onDragleave:S,onKeydown:r,onKeyup:B}),D("div",l,[te()].concat(ee()))}}),Object.assign(i,{removeAtIndex:g,removeFile:F,getNativeElement:()=>p.value}),pe(i,"nativeEl",()=>p.value),ge(u)}}),Be={class:"q-pa-md"},Qe={class:"row q-col-gutter-md q-px-md"},Le={key:0,class:"col-12"},qe={key:1,class:"col-12"},we={class:"col-12"},Ge={class:"col-12"},Z=Te({__name:"ETLDiagramImport",props:{modelValue:{type:Boolean,default:!1},isNewTopic:{type:Boolean,default:!1}},emits:["update:modelValue","jsonFile"],setup(t,{emit:d}){const{t:f}=be(),T=Ee(),i=V(),u=V(),p=V("");Ne(()=>{C(),O()});const b=V([]);function C(){const e={FinancialReport:"財務報表",GenerateInventoryData:"產生盤點資料",SendCustomerList:"發送客戶清單",PRO_INT_Vendor:"廠商主檔 ODS 2 INT",BI_Inventory_Report:"BI庫存報表",PRO_DM_MATERIAL_MONTHLY_PROCUREMENT_AMOUNT:"物料採購成本",Topic1:"廠商主檔 ODS 2 INT廠商主檔 ODS 2 INT廠商主檔 ODS 2 INT",PRO_INT_PART_ATTRIBUTE:"ODS_PRO_PART_MASTER to INT.INT_PRO_PURCHASING_PART_ATTRIBUTE",PRO_INT_MONTHLY_PROCUREMENT_AMOUNT:"ODS_PRO_PURCHASING_AMOUNT,INT.INT_PRO_PURCHASING_PART_ATTRIBUTE to INT_PRO_MONTHLY_PROCUREMENT_AMOUNT",PSG_EST_MONTHLY_REVENUE_DATA:"每月營業收入預估資料by客戶",PSG_DOI:"P.3.5.0 PSG DOI"},s=Object.keys(e).map(N=>({label:N+"-"+e[N],value:N}));b.value=s}const h=V([]);function O(){h.value=["ASUS","DGDEV","DGTest"]}ye(()=>{u.value=void 0,p.value="",i.value=void 0,C(),O()});const S=t,P=d;function R(){u.value=void 0,p.value="",i.value=void 0,P("update:modelValue",!1)}function U(){}const o=ae();function A(x){o.notify({type:"negative",message:"File did not pass validation constraints!!"})}return(x,e)=>(L(),Se(Re,{modelValue:S.modelValue,"onUpdate:modelValue":e[5]||(e[5]=s=>S.modelValue=s),persistent:""},{default:I(()=>[c(Fe,{style:{width:"500px"}},{default:I(()=>[c(Y,null,{default:I(()=>[c(ne,{class:"bg-primary text-white"},{default:I(()=>[c(ie,null,{default:I(()=>[Ie(Ve(y(f)("Import")),1)]),_:1}),c(q,{onClick:R,flat:"",round:"",dense:"",icon:"close"})]),_:1})]),_:1}),c(Y,null,{default:I(()=>[j("div",Be,[j("div",Qe,[S.isNewTopic?(L(),$("div",Le,[c(W,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),options:b.value,label:y(f)("Topic"),outlined:"",clearable:""},null,8,["modelValue","options","label"])])):(L(),$("div",qe,[c(Ce,{modelValue:y(T).Topic,"onUpdate:modelValue":e[1]||(e[1]=s=>y(T).Topic=s),label:y(f)("Topic"),outlined:"",readonly:"",dense:""},null,8,["modelValue","label"])])),j("div",we,[c(W,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),options:h.value,label:y(f)("DataBaseName")+"*",outlined:"",clearable:""},null,8,["modelValue","options","label"])]),j("div",Ge,[c(Me,{clearable:"",filled:"",counter:"",outlined:"",modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=s=>i.value=s),label:y(f)("JsonFile"),accept:".json",onRejected:A},{prepend:I(()=>[c(he,{name:"attach_file",onClick:e[3]||(e[3]=Oe(()=>{},["stop","prevent"]))})]),_:1},8,["modelValue","label"])])])])]),_:1}),c(De),c(Pe,{align:"right"},{default:I(()=>[c(q,{onClick:U,label:y(f)("Confirm"),color:"primary",class:"q-mr-sm"},null,8,["label"]),c(q,{onClick:R,label:y(f)("Cancel"),color:"negative",outline:""},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});typeof K=="function"&&K(Z);const Ze=Ue(Z,[["__scopeId","data-v-015cf999"]]);export{Ze as E};
