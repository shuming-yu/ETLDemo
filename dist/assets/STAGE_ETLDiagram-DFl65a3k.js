import{c as ye,o as be,h as N,a8 as et,ar as tt,u as ot,d as at,f as st,as as Re,g as nt,j as lt,r as D,at as rt,m as it,a as R,w as Te,au as dt,Y as Ne,t as Oe,ag as ut,x as ct,X as fe,a2 as Tt,F as Ae,H as we,s as ke,K as me,L as k,M as d,N as n,P as $,V as ge,ao as ve,O as T,T as i,af as mt,W as Ve,U as y,av as _t,aw as Et,G as pt,R as Ce,Z as te,Q as O,ae as oe,ax as Nt,ak as ft,al as gt,_ as he,ap as St,ac as Lt,aq as _e}from"./index-DxvJ3q3h.js";import{d as Me,f as Se,e as F,c as vt,Q as w,m as Ee}from"./PopupDialog-KTqEVNw1.js";import{Q as Ct}from"./QPage-f7Z2Te5d.js";import{Q as ht,a as Dt}from"./use-quasar-Qk2m7KF6.js";import{a as It}from"./QTable-miSyaNti.js";import{a as pe,e as De,d as xt}from"./webUtil-zFwJuEOQ.js";import{u as qe,b as Ie}from"./ETLRelation.jsonvuetypei18nindex0srctruelang-DtymqJE6.js";import{u as Ue,Q as Pt,a as yt,M as xe,_ as bt,b as Rt,E as Ot,D as At,c as wt,d as kt}from"./DefaultNode-eBXDh45n.js";import{b as Pe}from"./ETLInfo.jsonvuetypei18nindex0srctruelang-4JF1Bjs0.js";import{_ as Ye}from"./plugin-vueexport-helper-DlAUqK2U.js";import{E as Vt}from"./ETLDiagramImport-DhWS0kHx.js";import"./Utils-CGTrpKBe.js";import"./QScrollObserver-Ca9sQzqY.js";import"./TouchPan-YrgtzC7q.js";const Mt=ye({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(t,{slots:l,emit:x}){let f=!1,a,_,L=null,g=null,c,b;function v(){a?.(),a=null,f=!1,L!==null&&(clearTimeout(L),L=null),g!==null&&(clearTimeout(g),g=null),_?.removeEventListener("transitionend",c),c=null}function S(u,C,P){C!==void 0&&(u.style.height=`${C}px`),u.style.transition=`height ${t.duration}ms cubic-bezier(.25, .8, .50, 1)`,f=!0,a=P}function p(u,C){u.style.overflowY=null,u.style.height=null,u.style.transition=null,v(),C!==b&&x(C)}function V(u,C){let P=0;_=u,f===!0?(v(),P=u.offsetHeight===u.scrollHeight?0:void 0):(b="hide",u.style.overflowY="hidden"),S(u,P,C),L=setTimeout(()=>{L=null,u.style.height=`${u.scrollHeight}px`,c=I=>{g=null,(Object(I)!==I||I.target===u)&&p(u,"show")},u.addEventListener("transitionend",c),g=setTimeout(c,t.duration*1.1)},100)}function M(u,C){let P;_=u,f===!0?v():(b="show",u.style.overflowY="hidden",P=u.scrollHeight),S(u,P,C),L=setTimeout(()=>{L=null,u.style.height=0,c=I=>{g=null,(Object(I)!==I||I.target===u)&&p(u,"hide")},u.addEventListener("transitionend",c),g=setTimeout(c,t.duration*1.1)},100)}return be(()=>{f===!0&&v()}),()=>N(et,{css:!1,appear:t.appear,onEnter:V,onLeave:M},l.default)}}),q=tt({}),qt=Object.keys(Re),Ut=ye({name:"QExpansionItem",props:{...Re,...st,...at,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:{},headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...ot,"click","afterShow","afterHide"],setup(t,{slots:l,emit:x}){const{proxy:{$q:f}}=nt(),a=lt(t,f),_=D(t.modelValue!==null?t.modelValue:t.defaultOpened),L=D(null),g=rt(),{show:c,hide:b,toggle:v}=it({showing:_});let S,p;const V=R(()=>`q-expansion-item q-item-type q-expansion-item--${_.value===!0?"expanded":"collapsed"} q-expansion-item--${t.popup===!0?"popup":"standard"}`),M=R(()=>t.contentInsetLevel===void 0?null:{["padding"+(f.lang.rtl===!0?"Right":"Left")]:t.contentInsetLevel*56+"px"}),u=R(()=>t.disable!==!0&&(t.href!==void 0||t.to!==void 0&&t.to!==null&&t.to!=="")),C=R(()=>{const r={};return qt.forEach(h=>{r[h]=t[h]}),r}),P=R(()=>u.value===!0||t.expandIconToggle!==!0),I=R(()=>t.expandedIcon!==void 0&&_.value===!0?t.expandedIcon:t.expandIcon||f.iconSet.expansionItem[t.denseToggle===!0?"denseIcon":"icon"]),ae=R(()=>t.disable!==!0&&(u.value===!0||t.expandIconToggle===!0)),se=R(()=>({expanded:_.value===!0,detailsId:g.value,toggle:v,show:c,hide:b})),X=R(()=>{const r=t.toggleAriaLabel!==void 0?t.toggleAriaLabel:f.lang.label[_.value===!0?"collapse":"expand"](t.label);return{role:"button","aria-expanded":_.value===!0?"true":"false","aria-controls":g.value,"aria-label":r}});Te(()=>t.group,r=>{p?.(),r!==void 0&&z()});function W(r){u.value!==!0&&v(r),x("click",r)}function A(r){r.keyCode===13&&j(r,!0)}function j(r,h){h!==!0&&r.qAvoidFocus!==!0&&L.value?.focus(),v(r),Tt(r)}function ne(){x("afterShow")}function le(){x("afterHide")}function z(){S===void 0&&(S=dt()),_.value===!0&&(q[t.group]=S);const r=Te(_,U=>{U===!0?q[t.group]=S:q[t.group]===S&&delete q[t.group]}),h=Te(()=>q[t.group],(U,de)=>{de===S&&U!==void 0&&U!==S&&b()});p=()=>{r(),h(),q[t.group]===S&&delete q[t.group],p=void 0}}function re(){const r={class:[`q-focusable relative-position cursor-pointer${t.denseToggle===!0&&t.switchToggleSide===!0?" items-end":""}`,t.expandIconClass],side:t.switchToggleSide!==!0,avatar:t.switchToggleSide},h=[N(fe,{class:"q-expansion-item__toggle-icon"+(t.expandedIcon===void 0&&_.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:I.value})];return ae.value===!0&&(Object.assign(r,{tabindex:0,...X.value,onClick:j,onKeyup:A}),h.unshift(N("div",{ref:L,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),N(F,r,()=>h)}function H(){let r;return l.header!==void 0?r=[].concat(l.header(se.value)):(r=[N(F,()=>[N(Se,{lines:t.labelLines},()=>t.label||""),t.caption?N(Se,{lines:t.captionLines,caption:!0},()=>t.caption):null])],t.icon&&r[t.switchToggleSide===!0?"push":"unshift"](N(F,{side:t.switchToggleSide===!0,avatar:t.switchToggleSide!==!0},()=>N(fe,{name:t.icon})))),t.disable!==!0&&t.hideExpandIcon!==!0&&r[t.switchToggleSide===!0?"unshift":"push"](re()),r}function G(){const r={ref:"item",style:t.headerStyle,class:t.headerClass,dark:a.value,disable:t.disable,dense:t.dense,insetLevel:t.headerInsetLevel};return P.value===!0&&(r.clickable=!0,r.onClick=W,Object.assign(r,u.value===!0?C.value:X.value)),N(Me,r,H)}function ie(){return Oe(N("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:M.value,id:g.value},ct(l.default)),[[ut,_.value]])}function K(){const r=[G(),N(Mt,{duration:t.duration,onShow:ne,onHide:le},ie)];return t.expandSeparator===!0&&r.push(N(Ne,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:a.value}),N(Ne,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:a.value})),r}return t.group!==void 0&&z(),be(()=>{p?.()}),()=>N("div",{class:V.value},[N("div",{class:"q-expansion-item__container relative-position"},K())])}}),Yt=[{Name:"END",Type:"System",ExportName:"END"}],Ht=[{Name:"ETL_Test21",Type:"SP",ExportName:"ETL_Test21"},{Name:"ETL_Test23",Type:"SP",ExportName:"ETL_Test23"},{Name:"ETL_Test33",Type:"SP",ExportName:"ETL_Test33"},{Name:"ETL_Test_Period_S",Type:"SP",ExportName:"ETL_Test_Period_S"},{Name:"test1",Type:"SP",ExportName:"[dbo].[ETL_Test11]"}],Gt=[{Name:"ETL_Test13",Type:"SP",ExportName:"[dbo].[ETL_Test13]"},{Name:"ETL_Test31",Type:"SP",ExportName:"ETL_Test31"},{Name:"ETL_Test32",Type:"SP",ExportName:"ETL_Test32"},{Name:"ETL_Test_Period_R",Type:"SP",ExportName:"ETL_Test_Period_R"},{Name:"ETL_Test_Yearly_01",Type:"SP",ExportName:"ETL_Test_Yearly_01"}],Qt=[{Name:"DM_PRO_PURCHASING_MODE_AND_AMOUNT_DISTRIBUTION",Type:"SP",ExportName:"[sqlext].[ETL_DM_PRO_PURCHASING_MODE_AND_AMOUNT_DISTRIBUTION_SP]"},{Name:"ETL_BI_INVENTORY_Report",Type:"SP",ExportName:"[STAGE].[ETL_BI_INVENTORY_Report]"},{Name:"ETL_BI_INVENTORY_Report_Preview",Type:"SP",ExportName:"[STAGE].[ETL_BI_INVENTORY_Report_Preview]"},{Name:"ETL_DM_DOI_OVERVIEW",Type:"SP",ExportName:"[sqlext].[ETL_DM_DOI_OVERVIEW_SP]"},{Name:"ETL_DM_DOI_OVERVIEW_STOCK_AREA",Type:"SP",ExportName:"[sqlext].[ETL_DM_DOI_OVERVIEW_STOCK_AREA_SP]"},{Name:"ETL_INT_DOI_CURRENCY_CONVERSION_RATE_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_INT_DOI_CURRENCY_CONVERSION_RATE_MASTER_SP]"},{Name:"ETL_INT_DOI_INVENTORY_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_INT_DOI_INVENTORY_MASTER_SP]"},{Name:"ETL_INT_DOI_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_INT_DOI_MASTER_SP]"},{Name:"ETL_INT_DOI_TARGET_DAYS_PARAMETER",Type:"SP",ExportName:"[sqlext].[ETL_INT_DOI_TARGET_DAYS_PARAMETER_SP]"},{Name:"ETL_INT_PSG_EST_MONTHLY_REVENUE_DATA",Type:"SP",ExportName:"[sqlext].[ETL_INT_PSG_EST_MONTHLY_REVENUE_DATA_SP]"},{Name:"ETL_ODS_DOI_CURRENCY_CONVERSION_RATE_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_ODS_DOI_CURRENCY_CONVERSION_RATE_MASTER_SP]"},{Name:"ETL_ODS_DOI_INVENTORY_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_ODS_DOI_INVENTORY_MASTER_SP]"},{Name:"ETL_ODS_DOI_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_ODS_DOI_MASTER_SP]"},{Name:"ETL_ODS_DOI_TARGET_DAYS_PARAMETER",Type:"SP",ExportName:"[sqlext].[ETL_ODS_DOI_TARGET_DAYS_PARAMETER_SP]"},{Name:"ETL_ODS_PSG_EST_MONTHLY_REVENUE_DATA",Type:"SP",ExportName:"[sqlext].[ETL_ODS_PSG_EST_MONTHLY_REVENUE_DATA_SP]"},{Name:"ETL_Test12",Type:"SP",ExportName:"[dbo].[ETL_Test12]"},{Name:"ETL_Test22",Type:"SP",ExportName:"ETL_Test22"},{Name:"ETL_Test_Daily_01",Type:"SP",ExportName:"ETL_Test_Daily_01"},{Name:"ETL_Test_Daily_02",Type:"SP",ExportName:"ETL_Test_Daily_02"},{Name:"ETL_Test_Monthly_01",Type:"SP",ExportName:"ETL_Test_Monthly_01"},{Name:"ETL_Test_Period_C",Type:"SP",ExportName:"ETL_Test_Period_C"},{Name:"ETL_Test_Period_H",Type:"SP",ExportName:"ETL_Test_Period_H"},{Name:"ETL_Test_Weekly_01",Type:"SP",ExportName:"ETL_Test_Weekly_01"},{Name:"INT_PRO_MONTHLY_PROCUREMENT_AMOUNT",Type:"SP",ExportName:"[sqlext].[ETL_INT_PRO_MONTHLY_PROCUREMENT_AMOUNT_SP]"},{Name:"INT_PRO_PURCHASING_PART_ATTRIBUTE",Type:"SP",ExportName:"[sqlext].[ETL_INT_PRO_PURCHASING_PART_ATTRIBUTE_SP]"},{Name:"INT_PRO_VENDOR_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_INT_PRO_VENDOR_MASTER_SP]"},{Name:"ODS_PRO_PART_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_ODS_PRO_PART_MASTER_SP]"},{Name:"ODS_PRO_PURCHASING_AMOUNT",Type:"SP",ExportName:"[sqlext].[ETL_ODS_PRO_PURCHASING_AMOUNT_SP]"},{Name:"ODS_PRO_VENDOR_MASTER",Type:"SP",ExportName:"[sqlext].[ETL_ODS_PRO_VENDOR_MASTER_SP]"},{Name:"TESTTTTTTTTTTTTTTTTTTTT",Type:"Component",ExportName:"ComponentLoader2"}],Bt=[{Name:"Customer_CheckAddress",Type:"SP",ExportName:"[dbo].[ETL_Customer_CheckAddress]"},{Name:"Customer_CheckCustomer",Type:"SP",ExportName:"[dbo].[ETL_Customer_CheckCustomer]"},{Name:"Customer_SendMail",Type:"SP",ExportName:"[dbo].[ETL_Customer_SendMail]"},{Name:"ETL_Test_Period_F",Type:"SP",ExportName:"ETL_Test_Period_F"},{Name:"ETL_Test_Quarterly_01",Type:"SP",ExportName:"ETL_Test_Quarterly_01"},{Name:"Loader3",Type:"Component",ExportName:"ComponentLoader3"},{Name:"TestLoader1",Type:"Component",ExportName:"ComponentLoader1"}],$t={System:Yt,SendAlert:Ht,Report:Gt,DailyTask:Qt,Customer:Bt},Ft=["onDragstart"],He=Ae({__name:"Sidebar",setup(t){const{t:l}=we(),{onDragStart:x}=Ue();qe(),ke(()=>{a()});const f=D();function a(){f.value=$t}function _(c){return c==="SP"?"terminal":c==="Component"?"view_in_ar":c==="System"?"radio_button_checked":"terminal"}function L(c){return c==="System"?"vue-flow__node-output":"vue-flow__node-default"}function g(c){return c==="System"?"end":"default"}return(c,b)=>(k(),me(Pt,{class:"full-height",style:{"max-width":"300px"}},{default:d(()=>[n(vt,{style:{"max-width":"300px"}},{default:d(()=>[(k(!0),$(ge,null,ve(f.value,(v,S)=>(k(),me(Ut,{key:S,"expand-separator":"",label:S,"default-opened":"",dense:""},{default:d(()=>[(k(!0),$(ge,null,ve(v,(p,V)=>Oe((k(),me(Me,{key:V,clickable:"",dense:""},{default:d(()=>[n(F,{avatar:""},{default:d(()=>[n(fe,{name:_(p.Type),class:"q-ml-sm"},null,8,["name"])]),_:2},1024),n(F,null,{default:d(()=>[n(Se,null,{default:d(()=>[T("div",{class:mt([L(p.Type),"text-truncate"]),draggable:!0,onDragstart:M=>i(x)(M,g(p.Type),p.Name)},[Ve(y(p.Name)+" ",1),n(w,{class:"bg-teal-8 text-body2",anchor:"center right",self:"center left"},{default:d(()=>[T("strong",null,y(p.Name),1)]),_:2},1024)],42,Ft)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[_t]])),128))]),_:2},1032,["label"]))),128))]),_:1})]),_:1}))}});typeof Pe=="function"&&Pe(He);const Xt=Ye(He,[["__scopeId","data-v-475abcdb"]]),Wt=[{NodeId:"00638689177827118228",ETLName:"END",Period:"",Version:"S",Topic:"SendCustomerList",X:306,Y:450,Descr:"00638689177827119276",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},{NodeId:"00638689177827119267",ETLName:"Customer_CheckAddress",Period:"W",Version:"S",Topic:"SendCustomerList",X:121,Y:119,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},{NodeId:"00638689177827119272",ETLName:"Customer_CheckCustomer",Period:"W",Version:"S",Topic:"SendCustomerList",X:378,Y:120,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},{NodeId:"00638689177827119276",ETLName:"Customer_SendMail",Period:"M",Version:"S",Topic:"SendCustomerList",X:259,Y:331,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1}],jt=[{LinkId:"00638689177827119267-00638689177827119276",SrcNodeId:"00638689177827119267",SrcNode:{NodeId:"00638689177827119267",ETLName:"Customer_CheckAddress",Period:"W",Version:"S",Topic:"SendCustomerList",X:121,Y:119,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},DestNodeId:"00638689177827119276",DestNode:{NodeId:"00638689177827119276",ETLName:"Customer_SendMail",Period:"M",Version:"S",Topic:"SendCustomerList",X:259,Y:331,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},Level:1},{LinkId:"00638689177827119272-00638689177827119276",SrcNodeId:"00638689177827119272",SrcNode:{NodeId:"00638689177827119272",ETLName:"Customer_CheckCustomer",Period:"W",Version:"S",Topic:"SendCustomerList",X:378,Y:120,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},DestNodeId:"00638689177827119276",DestNode:{NodeId:"00638689177827119276",ETLName:"Customer_SendMail",Period:"M",Version:"S",Topic:"SendCustomerList",X:259,Y:331,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},Level:1},{LinkId:"00638689177827119276-00638689177827118228",SrcNodeId:"00638689177827119276",SrcNode:{NodeId:"00638689177827119276",ETLName:"Customer_SendMail",Period:"M",Version:"S",Topic:"SendCustomerList",X:259,Y:331,Descr:"",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},DestNodeId:"00638689177827118228",DestNode:{NodeId:"00638689177827118228",ETLName:"END",Period:"",Version:"S",Topic:"SendCustomerList",X:306,Y:450,Descr:"00638689177827119276",Editor:"IEC070511",Udt:"2024-12-04T14:03:07.8",Cdt:"2024-12-04T14:03:07.8",HasRelations:!1},Level:2}],zt={Nodes:Wt,Links:jt},Kt={key:0,class:"row full-height"},Jt={class:"col full-height",style:{"max-width":"300px"}},Zt={class:"q-pa-sm full-height"},eo={class:"col q-px-xs full-height"},to={class:"row q-pa-sm q-col-gutter-xs full-height"},oo={class:"col-12 row items-center q-gutter-xs"},ao={class:"col"},so={class:"col-12 full-height",elevation:"10"},no={key:0,class:"drop-text"},lo={class:"col-3 full-height"},ro={class:"full-height"},io={class:"row q-px-lg q-pb-sm q-col-gutter-sm"},uo={class:"col-12"},co={class:"col-12"},To={class:"col-12"},mo={class:"col-12"},Ge=Ae({__name:"STAGE_ETLDiagram",setup(t){const{t:l}=we(),x=Et(),f=pt(),a=qe(),{onConnect:_,addEdges:L,toObject:g,updateNode:c,onNodeClick:b,onEdgeClick:v,onNodeDoubleClick:S,onNodesChange:p,onEdgesChange:V,applyNodeChanges:M,applyEdgeChanges:u,setNodes:C,setEdges:P}=yt(),{onDragOver:I,onDrop:ae,onDropCancel:se,onDragLeave:X,isDragOver:W}=Ue(),A=D(!1),j=()=>{a.Period="",a.Descr="",A.value=!0},ne=()=>{A.value=!1};function le(){if(!a.Period||!a.Period.trim()){let s=l("MsgPleaseInput",[l("Period")]);pe(s);return}a.NodeId&&c(a.NodeId,s=>({...s,label:s.label,data:{...s.data,Period:a.Period,Version:a.Version,Topic:a.Topic,X:s.position.x,Y:s.position.y,Descr:a.Descr,Color:"black"}})),A.value=!1}function z(){!a.NodeId||!a.ETLName||!a.Period||(A.value=!0)}_(s=>{L({...s,id:s.source+"-"+s.target,type:"smoothstep",markerEnd:xe.ArrowClosed,data:{LinkId:s.source+"-"+s.target,SrcNodeId:s.source,DestNodeId:s.target}})}),ke(()=>{a.Topic=x.query.topic,a.Version=x.query.version,a.Topic&&a.Version&&r(a.Topic,a.Version),U(),ce()});function re(){f.push("/ETL/ETLFlow/STAGE")}const H=D([]),G=D([]);function ie(s){return s==="END"?"end":"default"}function K(s,o){H.value=s.map(e=>({id:e.NodeId,label:e.ETLName,position:{x:parseFloat(e.X),y:parseFloat(e.Y)},type:ie(e.ETLName),data:{...e,X:parseFloat(e.X),Y:parseFloat(e.Y),Color:e.HasRelations?"red":"black"}})),G.value=o.map(e=>({id:e.LinkId,source:e.SrcNodeId,target:e.DestNodeId,type:"smoothstep",markerEnd:xe.ArrowClosed,data:{...e}}))}function r(s,o){""+new URLSearchParams({topic:s,version:o}).toString();let{Nodes:m,Links:E}=zt;K(m,E)}const h=D([]);function U(){const o={R:"週期單位:15分鐘, ex:[00,15,30,45]",F:"週期單位:30分鐘, ex:[00,30]",H:"週期單位:1小時, 每個整點, ex:[01:00,12:00,23:00]",S:"週期單位:1節, ex:[ 08:00-13:00,13:00-17:00,17:00-20:30,20:30-23:00,23:00-03:00,03:00-08:00]",C:"週期單位:1班, ex:[ 08:00-20:30,20:30-08:00]",P:"週期單位:1天(自訂起迄時間), ex:[08:00-隔天08:00]",D:"週期單位:1天(系統日), ex:[00:00-隔天00:00]",W:"週期單位:1周, 星期日為一周第一天,星期六為一周最後一天",M:"週期單位:1月",Q:"週期單位:1季",Y:"週期單位:1年"},e=Object.keys(o).map(m=>({label:m+"-"+o[m],value:m}));h.value=e}function de(s){let e=l("MsgConfirmApprove",["PRD"]);_e.create({component:Ee,componentProps:{title:l("Approve"),titleClass:"bg-brown text-white",message:e}}).onOk(()=>{})}function Qe(s,o){return s.forEach(e=>{e.data.X=Math.round(e.position.x),e.data.Y=Math.round(e.position.y)}),o.filter(e=>e.hasOwnProperty("sourceX"))}function Be(){let s=g();const o=Qe(s.nodes,s.edges);a.Version,a.Topic,s.nodes.map(m=>m.data),o.map(m=>m.data);let e=`${l("Save")}${l("Success")}`;De(e)}function $e(){let s=l("Topic")+": "+a.Topic,o=l("MsgConfirmClear",[s]);_e.create({component:Ee,componentProps:{title:l("ClearDiagram"),titleClass:"bg-negative text-white",message:o}}).onOk(()=>{Fe()})}function Fe(){""+new URLSearchParams({topic:a.Topic,version:a.Version}).toString()}const Xe=()=>{H.value=[],G.value=[]},J=D(!1);function We(s,o,e){if(o){if(!e){let E=l("MsgPleaseSelect",[l("JsonFile")]);pe(E);return}}else{let E=l("MsgPleaseSelect",[l("DataBaseName")]);pe(E);return}xt("ETLManager/ETLDiagram/ImportDiagram",a.Topic,o,e).then(E=>{J.value=!1,Xe(),K(E.Nodes,E.Links);let ee=`${l("Import")}${l("Success")}`;De(ee)}).catch(E=>{console.log(E)})}const Z=D(""),Y=D();let ue=!1;function Le(){return Y.value||(Y.value=new Promise(s=>{let o=l("MsgConfirmDelete",[Z.value]);_e.create({component:Ee,componentProps:{title:l("Delete"),titleClass:"bg-negative text-white",message:o}}).onOk(async()=>{s(!0),Y.value=null}).onCancel(async()=>{s(!1),Y.value=null}).onDismiss(()=>{s(!1),Y.value=null})})),Y.value}p(async s=>{const o=[];for(const e of s)e.type==="remove"?a.ControlDeleteNode?(o.push(e),a.ControlDeleteNode=!1):await Le()&&(Q.value=void 0,B.value=void 0,o.push(e)):o.push(e);M(o)}),V(async s=>{const o=[];for(const e of s)if(e.type==="remove")if(ue)o.push(e);else if(await Le())ue=!0,o.push(e);else break;else o.push(e);ue=!1,u(o)});let Q=D();function je(s,o,e,m){""+new URLSearchParams({etlName:s,topic:o,period:e,nodeId:m}).toString(),Q.value={NodeName:"Customer_CheckCustomer",NodeId:"00638689177827119272",Period:"W",Topic:"SendCustomerList",X:"0",Y:"0",Name:"Customer_CheckCustomer",DataBaseName:"DGTest",ExportName:"[dbo].[ETL_Customer_CheckCustomer]",Type:"SP",Category:"Customer",OwnerEmail:"yao.nai-wen@inventec.com",Descr:"檢查客戶清單",Editor:"IEC070511",Udt:"2024-11-01T11:11:41.837",Cdt:"2024-11-01T11:11:41.837"}}let B=D();function ze(s,o,e,m){""+new URLSearchParams({etlName:s,period:o,excludeTopic:e,version:m}).toString(),B.value={ID:7,ETLName:"Customer_CheckAddress",Period:"W",Before:"2024-10-26T00:00:00",FromPeriod:"2024-11-02T00:00:00",ToPeriod:"2024-11-30T00:00:00",After:"2024-12-07T00:00:00",UsageTime:6,ReturnCode:0,ErrorText:"",Category:"",Topic:"",Level:1,Dependence:""}}b(({event:s,node:o})=>{let{ETLName:e,Topic:m,Period:E,NodeId:ee,Version:Je,Descr:Ze}=o.data;if(e=="END"?(Z.value="Node:"+e,ce()):(Z.value="Node:"+e+"-Period ("+E+")",a.NodeId=ee,a.ETLName=e,a.Period=E,a.Descr=Ze),e=="END"){Q.value=void 0,B.value=void 0;return}e&&(je(e,m,E,ee),ze(e,E,m,Je))}),v(({event:s,edge:o})=>{ce();let e=o.sourceNode.data.ETLName,m=o.targetNode.data.ETLName;Z.value="Link:"+e+"-"+m});function Ke(){r(a.Topic,a.Version),Q.value=void 0,B.value=void 0}function ce(){a.NodeId="",a.ETLName="",a.Period="",a.Descr=""}return(s,o)=>(k(),$(ge,null,[n(Ct,{class:"q-pa-sm bg-white page-height"},{default:d(()=>[s.$q.screen.lt.sm?Ce("",!0):(k(),$("div",Kt,[T("div",Jt,[n(te,{class:"no-shadow full-height",bordered:""},{default:d(()=>[T("div",Zt,[n(Xt)])]),_:1})]),T("div",eo,[n(te,{class:"no-shadow full-height",style:{overflow:"hidden"},bordered:""},{default:d(()=>[T("div",to,[T("div",oo,[n(O,{onClick:re,icon:"arrow_back",size:"md",round:"",flat:"",dense:"",class:"bg-grey-8 text-white"},{default:d(()=>[n(w,{class:"bg-grey-8 text-body2",anchor:"bottom middle",self:"top middle"},{default:d(()=>[T("strong",null,y(i(l)("ArrowBack")),1)]),_:1})]),_:1}),n(O,{onClick:o[0]||(o[0]=e=>de(i(a).Topic)),icon:"sym_o_fact_check",size:"md",round:"",flat:"",dense:"",class:"bg-brown text-white"},{default:d(()=>[n(w,{class:"bg-brown text-body2",anchor:"bottom middle",self:"top middle"},{default:d(()=>[T("strong",null,y(i(l)("Approve")),1)]),_:1})]),_:1}),n(O,{onClick:Be,icon:"save",size:"md",round:"",flat:"",dense:"",class:"bg-primary text-white"},{default:d(()=>[n(w,{class:"bg-primary text-body2",anchor:"bottom middle",self:"top middle"},{default:d(()=>[T("strong",null,y(i(l)("Save")),1)]),_:1})]),_:1}),n(O,{onClick:z,icon:"edit",size:"md",round:"",flat:"",dense:"",class:"bg-secondary text-white"},{default:d(()=>[n(w,{class:"bg-secondary text-body2",anchor:"bottom middle",self:"top middle"},{default:d(()=>[T("strong",null,y(i(l)("Edit")),1)]),_:1})]),_:1}),n(O,{onClick:$e,icon:"sym_o_mop",size:"md",round:"",flat:"",dense:"",class:"bg-negative text-white"},{default:d(()=>[n(w,{class:"bg-negative text-body2",anchor:"bottom middle",self:"top middle"},{default:d(()=>[T("strong",null,y(i(l)("ClearDiagram")),1)]),_:1})]),_:1}),n(O,{onClick:o[1]||(o[1]=e=>J.value=!0),icon:"sym_o_convert_to_text",size:"md",round:"",flat:"",dense:"",class:"bg-positive text-white"},{default:d(()=>[n(w,{class:"bg-positive text-body2",anchor:"bottom middle",self:"top middle"},{default:d(()=>[T("strong",null,y(i(l)("Import")),1)]),_:1})]),_:1}),n(O,{onClick:Ke,icon:"refresh",size:"md",round:"",flat:"",dense:"",class:"bg-warning text-white"},{default:d(()=>[n(w,{class:"bg-warning text-body2",anchor:"bottom middle",self:"top middle"},{default:d(()=>[T("strong",null,y(i(l)("Refresh")),1)]),_:1})]),_:1}),T("div",ao,[n(oe,{modelValue:i(a).Topic,"onUpdate:modelValue":o[2]||(o[2]=e=>i(a).Topic=e),label:i(l)("Topic"),outlined:"",readonly:"",dense:""},null,8,["modelValue","label"])])]),T("div",so,[T("div",{class:"dnd-flow",onDrop:o[3]||(o[3]=e=>i(ae)(e,j))},[n(i(bt),{nodes:H.value,edges:G.value,onDragover:i(I),onDragleave:i(X),"apply-default":!1,"delete-key-code":"Delete"},{"node-default":d(e=>[n(At,ft(gt(e)),null,16)]),"node-end":d(e=>[n(Ot)]),default:d(()=>[n(Rt,{class:"overlay",style:Nt({backgroundColor:i(W)?"#e7f3ff":"transparent",transition:"background-color 0.2s ease"})},{default:d(()=>[i(W)?(k(),$("p",no,"Drop here")):Ce("",!0)]),_:1},8,["style"])]),_:1},8,["nodes","edges","onDragover","onDragleave"]),n(i(wt))],32)])])]),_:1})]),T("div",lo,[n(te,{class:"no-shadow full-height",bordered:""},{default:d(()=>[T("div",ro,[n(kt,{ETLNameInfo:i(Q),ETLExecuteData:i(B)},null,8,["ETLNameInfo","ETLExecuteData"])])]),_:1})])]))]),_:1}),n(Lt,{modelValue:A.value,"onUpdate:modelValue":o[9]||(o[9]=e=>A.value=e),persistent:""},{default:d(()=>[n(te,{style:{width:"500px"}},{default:d(()=>[n(he,{class:"q-pa-none"},{default:d(()=>[n(ht,{class:"bg-primary text-white"},{default:d(()=>[n(Dt,null,{default:d(()=>[Ve(y(i(l)("Setting")),1)]),_:1})]),_:1})]),_:1}),n(he,null,{default:d(()=>[T("div",io,[T("div",uo,[n(oe,{modelValue:i(a).Topic,"onUpdate:modelValue":o[4]||(o[4]=e=>i(a).Topic=e),label:i(l)("Topic"),readonly:""},null,8,["modelValue","label"])]),T("div",co,[n(oe,{modelValue:i(a).ETLName,"onUpdate:modelValue":o[5]||(o[5]=e=>i(a).ETLName=e),label:i(l)("ETLName"),readonly:""},null,8,["modelValue","label"])]),T("div",To,[n(It,{modelValue:i(a).Period,"onUpdate:modelValue":o[6]||(o[6]=e=>i(a).Period=e),options:h.value,label:i(l)("Period")+"*",outlined:"",clearable:"","emit-value":"","map-options":""},null,8,["modelValue","options","label"])]),T("div",mo,[n(oe,{modelValue:i(a).Descr,"onUpdate:modelValue":o[7]||(o[7]=e=>i(a).Descr=e),label:i(l)("Descr")},null,8,["modelValue","label"])])])]),_:1}),n(Ne),n(St,{align:"right"},{default:d(()=>[n(O,{label:i(l)("Confirm"),onClick:le,color:"primary",class:"q-mr-sm"},null,8,["label"]),n(O,{label:i(l)("Cancel"),onClick:o[8]||(o[8]=e=>i(se)(ne)),color:"negative",outline:""},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(Vt,{modelValue:J.value,"onUpdate:modelValue":o[10]||(o[10]=e=>J.value=e),onJsonFile:We,isNewTopic:!1},null,8,["modelValue"])],64))}});typeof Ie=="function"&&Ie(Ge);const Po=Ye(Ge,[["__scopeId","data-v-598f3b2e"]]);export{Po as default};
