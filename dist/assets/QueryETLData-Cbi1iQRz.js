import{c as te,a as ee,h as ne,x as se,F as I,ah as re,H as le,ai as ie,w as ue,ad as oe,C as U,K as k,L as u,M as a,P as h,V as C,R as V,N as o,W as y,U as i,O as d,T as s,aj as j,af as x,ak as de,al as ce,am as me,s as pe,r as fe,an as be,ae as G,X as O,Q as q,t as R,ag as $,ao as F,ac as he,Z as ge,_ as ye}from"./index-tdpVI09P.js";import{b as K,a as Te,Q as W,c as we,d as A}from"./QTable-C1QJS2Kk.js";import{Q as g,b as X}from"./ETLGroupByTopic.json_vue_type_i18n_index_0_src_true_lang-ZW7JnY_v.js";import{Q}from"./QBadge-CWsIxMxB.js";import{d as Z,e as J,m as _,l as H,Q as Y,C as ve}from"./webUtil-BauTstjd.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M=te({name:"QTr",props:{props:Object,noHover:Boolean},setup(T,{slots:t}){const p=ee(()=>"q-tr"+(T.props===void 0||T.props.header===!0?"":" "+T.props.__trClass)+(T.noHover===!0?" q-tr--no-hover":""));return()=>ne("tr",{style:T.props?.__trStyle,class:p.value},se(t.default))}}),Ce={key:0,class:"col ellipsis"},_e={key:1,class:"col text-center"},ke={key:1},Se=I({name:"MSelect",__name:"MSelect",props:re({leftLabel:{type:Boolean,default:!0},showCheckedAll:{type:Boolean,default:!0},checkedEllipsis:{type:Boolean,default:!1},name:{},virtualScrollHorizontal:{type:Boolean},virtualScrollSliceSize:{},virtualScrollSliceRatioBefore:{},virtualScrollSliceRatioAfter:{},virtualScrollItemSize:{},virtualScrollStickySizeStart:{},virtualScrollStickySizeEnd:{},tableColspan:{},modelValue:{},error:{type:[Boolean,null]},errorMessage:{},noErrorIcon:{type:Boolean},rules:{},reactiveRules:{type:Boolean},lazyRules:{type:[Boolean,String]},label:{},stackLabel:{type:Boolean},hint:{},hideHint:{type:Boolean},prefix:{},suffix:{},labelColor:{},color:{},bgColor:{},dark:{type:[Boolean,null]},loading:{type:Boolean},clearable:{type:Boolean},clearIcon:{},filled:{type:Boolean},outlined:{type:Boolean},borderless:{type:Boolean},standout:{type:[Boolean,String]},labelSlot:{type:Boolean},bottomSlots:{type:Boolean},hideBottomSpace:{type:Boolean},counter:{type:Boolean},rounded:{type:Boolean},square:{type:Boolean},dense:{type:Boolean},itemAligned:{type:Boolean},disable:{type:Boolean},readonly:{type:Boolean},autofocus:{type:Boolean},for:{},multiple:{type:Boolean,default:!0},displayValue:{},displayValueHtml:{type:Boolean},options:{},optionValue:{},optionLabel:{},optionDisable:{},hideSelected:{type:Boolean},hideDropdownIcon:{type:Boolean},dropdownIcon:{},maxValues:{},optionsDense:{type:Boolean},optionsDark:{type:[Boolean,null]},optionsSelectedClass:{},optionsHtml:{type:Boolean},optionsCover:{type:Boolean},menuShrink:{type:Boolean},menuAnchor:{},menuSelf:{},menuOffset:{},popupContentClass:{},popupContentStyle:{},popupNoRouteDismiss:{type:Boolean},useChips:{type:Boolean},useInput:{type:Boolean},maxlength:{},fillInput:{type:Boolean},newValueMode:{},mapOptions:{type:Boolean},disableTabSelection:{type:Boolean},emitValue:{type:Boolean},inputDebounce:{},inputClass:{},inputStyle:{},tabindex:{},autocomplete:{},transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{},onVirtualScroll:{},"onUpdate:modelValue":{},onFocus:{},onBlur:{},onClear:{},onInputValue:{},onRemove:{},onAdd:{},onNewValue:{},onFilter:{},onFilterAbort:{},onPopupShow:{},onPopupHide:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const{t}=le();let p=ie(T,"modelValue");ue(p,l=>{(l?.length||0)===0?f.checked=!1:l.length===S.value?.length?f.checked=!0:f.checked=null});const E=T;let{options:S,emitValue:b,leftLabel:w}=oe(E),f=U({label:t("CheckedAll"),checked:!1,toggle:()=>{f.checked=!f.checked,f.toggleAll()},toggleAll:()=>{f.checked?p.value=S.value?.map(l=>b.value?l.value:l):p.value=[]}});return(l,v)=>(u(),k(Te,{modelValue:s(p),"onUpdate:modelValue":v[1]||(v[1]=B=>me(p)?p.value=B:p=B),options:s(S),label:l.label,autofocus:l.autofocus,"bg-color":l.bgColor,borderless:l.borderless,clearable:l.clearable,color:l.color,dark:l.dark,dense:l.dense,disable:l.disable,"emit-value":s(b),filled:l.filled,"hide-bottom-space":l.hideBottomSpace,"input-class":l.inputClass,"input-style":l.inputStyle,"label-color":l.labelColor,"map-options":l.mapOptions,"max-values":l.maxValues,multiple:l.multiple,name:l.name,outlined:l.outlined,readonly:l.readonly,rounded:l.rounded,square:l.square,tabindex:l.tabindex,onFocus:l.onFocus,onBlur:l.onBlur,onClear:l.onClear,onPopupShow:l.onPopupShow,onPopupHide:l.onPopupHide},{option:a(({itemProps:B,opt:r,selected:n,toggleOption:e,index:c})=>[c===0&&l.multiple&&l.showCheckedAll?(u(),k(Z,{key:0,onClick:s(f).toggle,class:"non-selectable",clickable:""},{default:a(()=>[o(J,null,{default:a(()=>[o(j,{modelValue:s(f).checked,"onUpdate:modelValue":[v[0]||(v[0]=m=>s(f).checked=m),s(f).toggleAll],label:s(f).label,class:x({"justify-between":s(w),"text-weight-bold":!0}),"left-label":s(w)},null,8,["modelValue","label","class","left-label","onUpdate:modelValue"])]),_:1})]),_:1},8,["onClick"])):V("",!0),o(Z,de(ce(B)),{default:a(()=>[o(J,null,{default:a(()=>[o(j,{"model-value":n,label:r?.label||r,class:x({"justify-between":s(w)}),"left-label":s(w),"onUpdate:modelValue":m=>e(r)},null,8,["model-value","label","class","left-label","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),"selected-item":a(({opt:B,index:r})=>[l.checkedEllipsis?(u(),h(C,{key:0},[r<2?(u(),h("div",Ce,[o(K,{ripple:!1,dense:""},{default:a(()=>[y(i(B?.label||B),1)]),_:2},1024)])):V("",!0),r==2?(u(),h("div",_e,[d("span",null,i(`(+${s(p).length-2} others)`),1)])):V("",!0)],64)):(u(),h(C,{key:1},[r<2?(u(),k(K,{key:0,ripple:!1,dense:""},{default:a(()=>[y(i(B?.label||B),1)]),_:2},1024)):V("",!0),r===2?(u(),h("span",ke,i(`(+${s(p).length-2} others)`),1)):V("",!0)],64))]),_:1},8,["modelValue","options","label","autofocus","bg-color","borderless","clearable","color","dark","dense","disable","emit-value","filled","hide-bottom-space","input-class","input-style","label-color","map-options","max-values","multiple","name","outlined","readonly","rounded","square","tabindex","onFocus","onBlur","onClear","onPopupShow","onPopupHide"]))}}),Ve={class:"q-table__title"},Le={class:"col"},Ee={class:"row justify-end items-center"},Pe={class:"row items-center no-wrap"},De={class:"row items-center"},Re={key:0,class:"row items-center no-wrap"},Qe={class:"absolute-full"},Ue={class:"row fit justify-end q-pa-xs"},Ne={class:"q-table__title"},qe={class:"col"},$e={class:"row justify-end items-center q-col-gutter-sm q-ma-none"},Fe={class:"text-caption self-end"},Ae={class:"row items-center no-wrap"},ae=I({__name:"ETLGroupByTopic",props:{showHeader:{type:Boolean,default:!1},recordCount:{default:100}},setup(T){const{t}=le(),p=T;let{recordCount:E}=oe(p);pe(()=>{f()});function S(r,n,e){return n.UsageTime==0n?e?100:1:e==!0?parseFloat((Number(r.UsageTime)/Number(n.UsageTime)*100).toFixed(0)):Number(r.UsageTime)/Number(n.UsageTime)}const b=U({rows:[],columns:[{name:"ETLName",label:t("ETLName"),field:"ETLName",align:"left",sortable:!1},{name:"Period",label:t("Period"),field:"Period",align:"left",sortable:!1},{name:"ReturnCode",label:t("ReturnCode"),field:"ReturnCode",align:"left",sortable:!1},{name:"FromPeriod",label:t("FromPeriod"),field:"FromPeriod",format:_.fullDateTime,align:"center",sortable:!1},{name:"ToPeriod",label:t("ToPeriod"),field:"ToPeriod",format:_.fullDateTime,align:"center",sortable:!1},{name:"Level",label:t("Level"),field:"Level",align:"center",sortable:!1},{name:"UsageTime",label:t("UsageTime"),field:"UsageTime",align:"center",sortable:!1},{name:"ErrorText",label:t("ErrorText"),field:"ErrorText",align:"left",sortable:!1}],filter:"",filterMethod:function(r,n,e,c){let m=n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&");if(m){let P=new RegExp(m,"i");return r.filter(z=>{let L=P.test(z.Topic);return L||(z.ETLDatas.forEach(D=>{L||(L=[D.ETLName,D.ErrorText,D.Category,D.Period].map(N=>P.test(N)).filter(N=>N).length>0)}),L)})}return r}});b.displayRows=ee(()=>{if(w.modelValue){let r=Object.values(w.modelValue);if(r.length>0)return b.rows.filter(n=>r.includes(n.Topic))}return b.rows});const w=U({modelValue:null,options:[]});function f(){H("/ETLManager/ETLData/GetETLDatasByTopic").then(n=>{b.rows=n}),H("/ETLManager/Common/GetETLTopics").then(n=>{w.options=Object.keys(n).map(e=>({label:`${e}-${n[e]}`,value:e}))})}const l=fe(!1),v=U({rows:[],columns:[{name:"ActionName",label:t("ActionName"),field:"ActionName",align:"left",sortable:!0},{name:"ETLName",label:t("ETLName"),field:"ETLName",align:"left"},{name:"Period",label:t("Period"),field:"Period",align:"left"},{name:"ReturnCode",label:t("ReturnCode"),field:"ReturnCode",align:"center"},{name:"UsageTime",label:t("UsageTime"),field:"UsageTime",align:"center",sortable:!0},{name:"PeriodDate",label:t("PeriodDate"),field:"PeriodDate",align:"left",format:_.fullDateTime,sortable:!0},{name:"ErrorText",label:t("ErrorText"),field:"ErrorText",align:"left"},{name:"Cdt",label:t("Cdt"),field:"Cdt",align:"left",format:_.fullDateTime,sortable:!0}],filter:""});function B(r){let{ETLName:n,Period:e}=r,m="/ETLManager/ETLData/GetETLDataLogs?"+new URLSearchParams({period:e,name:n,recordCount:E.value.toString()}).toString();H(m).then(P=>{v.rows=P,l.value=!0})}return(r,n)=>(u(),h(C,null,[o(W,{rows:b.displayRows,columns:b.columns,filter:b.filter,"filter-method":b.filterMethod,hideBottom:!0,"rows-per-page-options":[0],"row-key":"Topic",class:"shadow-5 table-topicgroup",style:{"max-height":"100%"},flat:"",dense:"",bordered:""},be({header:a(e=>[o(M,{props:e},{default:a(()=>[o(A,{"auto-width":""}),o(A,{"auto-width":""}),(u(!0),h(C,null,F(e.cols,c=>(u(),k(A,{key:c.name,props:e},{default:a(()=>[y(i(c.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(e=>[o(M,{props:e,class:"text-bold",style:{"background-color":"#e5f3f3"}},{default:a(()=>[o(g,null,{default:a(()=>[o(q,{class:x(e.expand?"text-blue":""),icon:e.expand?"keyboard_arrow_down":"keyboard_arrow_right",size:"sm",onClick:c=>e.expand=!e.expand,flat:"",dense:"",round:""},null,8,["class","icon","onClick"])]),_:2},1024),o(g,{colspan:"3",class:"text-blue"},{default:a(()=>[y(i(e.row.Topic),1)]),_:2},1024),o(g,null,{default:a(()=>[d("div",Pe,[o(Q,{color:e.row.ReturnCode==0?"green":"red",class:"q-mx-sm",rounded:""},null,8,["color"]),R(d("span",null,i(e.row.ReturnCode),513),[[$,e.row.ReturnCode!=0]])])]),_:2},1024),o(g,{class:"text-center"},{default:a(()=>[y(i(s(_).fullDateTime(e.row.FromPeriod,null)),1)]),_:2},1024),o(g,{class:"text-center"},{default:a(()=>[y(i(s(_).fullDateTime(e.row.ToPeriod,null)),1)]),_:2},1024),o(g,{class:"text-center"},{default:a(()=>[y(i(e.row.Level),1)]),_:2},1024),o(g,{class:"text-center"},{default:a(()=>[y(i(e.row.UsageTime),1)]),_:2},1024),o(g)]),_:2},1032,["props"]),e.expand?(u(!0),h(C,{key:0},F(e.row.ETLDatas,c=>(u(),k(M,null,{default:a(()=>[o(g),o(g,null,{default:a(()=>[d("div",De,[o(q,{icon:"search",color:"blue-8",onClick:()=>B(c),flat:"",dense:"",round:""},{default:a(()=>[o(Y,{class:"bg-blue-8"},{default:a(()=>[y(i(s(t)("QueryETLLog")),1)]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024),(u(!0),h(C,null,F(e.cols,m=>(u(),k(g,{key:m.name,props:e},{default:a(()=>[m.name=="ReturnCode"?(u(),h("div",Re,[o(Q,{color:c[m.name]==0?"green":"red",class:"q-mx-sm",rounded:""},null,8,["color"]),R(d("span",null,i(c[m.name]),513),[[$,c[m.name]!=0]])])):m.name=="UsageTime"?(u(),k(we,{key:1,value:S(c,e.row),size:"1.5rem",color:"green"},{default:a(()=>[d("div",Qe,[d("div",Ue,[o(Q,{label:`${S(c,e.row,!0)}%`,class:"text-weight-bold",color:"white","text-color":"green",style:{"font-size":".625rem"}},null,8,["label"]),o(Y,null,{default:a(()=>[y(i(`${c.UsageTime} (ms)`),1)]),_:2},1024)])])]),_:2},1032,["value"])):["FromPeriod","ToPeriod"].includes(m.name)?(u(),h(C,{key:2},[y(i(s(_).fullDateTime(c[m.name],null)),1)],64)):(u(),h(C,{key:3},[y(i(c[m.name]),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1024))),256)):V("",!0)]),_:2},[r.showHeader?{name:"top",fn:a(()=>[d("div",Ve,i(s(t)("TitleETLData")),1),d("div",Le,[d("div",Ee,[o(Se,{modelValue:w.modelValue,"onUpdate:modelValue":n[0]||(n[0]=e=>w.modelValue=e),options:w.options,label:s(t)("ETLTopic"),style:{width:"360px"},color:"blue",class:"q-mr-sm",dense:"",outlined:"","emit-value":"","map-options":"","checked-ellipsis":"","hide-bottom-space":""},null,8,["modelValue","options","label"]),o(G,{modelValue:b.filter,"onUpdate:modelValue":n[1]||(n[1]=e=>b.filter=e),label:s(t)("Search"),color:"primary",clearable:"",dense:""},{prepend:a(()=>[o(O,{name:"search"})]),_:1},8,["modelValue","label"])])])]),key:"0"}:void 0]),1032,["rows","columns","filter","filter-method"]),o(he,{modelValue:l.value,"onUpdate:modelValue":n[3]||(n[3]=e=>l.value=e)},{default:a(()=>[o(ge,{class:"full-height",style:{"max-width":"80vw"}},{default:a(()=>[o(ye,{class:"full-height q-pa-none"},{default:a(()=>[o(W,{rows:v.rows,columns:v.columns,filter:v.filter,"rows-per-page-options":[0],class:"full-height",bordered:"",dense:"",flat:""},{top:a(()=>[d("div",Ne,i(s(t)("TitleETLLog")),1),d("div",qe,[d("div",$e,[d("div",Fe,i(s(t)("DisplayRecordCount",[s(E)])),1),o(G,{modelValue:v.filter,"onUpdate:modelValue":n[2]||(n[2]=e=>v.filter=e),label:s(t)("Search"),color:"primary",clearable:"",dense:""},{prepend:a(()=>[o(O,{name:"search"})]),_:1},8,["modelValue","label"]),R(o(q,{icon:"close",dense:"",flat:"",round:""},null,512),[[ve]])])])]),"body-cell-ReturnCode":a(({row:e})=>[o(g,null,{default:a(()=>[d("div",Ae,[o(Q,{color:e.ReturnCode==0?"green":"red",class:"q-mx-sm",rounded:""},null,8,["color"]),R(d("span",null,i(e.ReturnCode),513),[[$,e.ReturnCode!=0]])])]),_:2},1024)]),_:1},8,["rows","columns","filter"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}});typeof X=="function"&&X(ae);const He=Be(ae,[["__scopeId","data-v-64830b4b"]]),Me={class:"page-height"},xe={class:"column fit q-pa-sm"},Ie={class:"col full-height"},Ze=I({__name:"QueryETLData",setup(T){return(t,p)=>(u(),h("div",Me,[d("div",xe,[d("div",Ie,[o(He,{showHeader:""})])])]))}});export{Ze as default};
