import{F as N,H as M,G as R,s as A,C as B,r as H,P,L as c,O as l,N as s,M as o,_ as x,Z as v,K as _,R as b,W as p,U as i,S as U,ap as F,Q as w,T as m,ae as G,X as O,V as z,aq as D}from"./index-weJWtW1h.js";import{Q as Y}from"./QBadge-BZCDV2mU.js";import{Q as u,l as J,m as V}from"./PopupDialog-CTxAAtoL.js";import{Q as W}from"./QTable-jeqM6Mmq.js";import{a as j}from"./allETLTopics-Dpv7HU38.js";import{a as y,d as K,e as X}from"./webUtil-DDMYn3Nb.js";import{u as Z,b as C}from"./ETLRelation.jsonvuetypei18nindex0srctruelang-D4kxEK6b.js";import{E as ee}from"./ETLDiagramImport-BKMYwtnR.js";import{_ as te}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./use-quasar-D-hVknpX.js";import"./ETLInfo.jsonvuetypei18nindex0srctruelang-4JF1Bjs0.js";const le={class:"page-height"},oe={class:"column fit q-pa-sm"},se={class:"col full-height"},ae={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3"},ne={class:"row"},ie={class:"col-10"},re={class:"text-subtitle1 ellipsis"},de={class:"text-subtitle1 ellipsis"},ce={class:"col-2 flex flex-center"},me={class:"col-6 q-gutter-sm q-px-sm",style:{"white-space":"nowrap"}},ue={class:"col-6 text-right"},fe={class:"text-caption text-grey-8"},ge={class:"text-caption text-grey-8"},_e="P",L="S",k=N({__name:"STAGE_ETLRelation",setup(be){const{t}=M(),S=R(),h=Z();A(()=>{T()});const r=B({filter:"",rows:[],columns:[{name:"ID",label:t("ID"),field:"ID",align:"left",sortable:!0},{name:"Type",label:t("Type"),field:"Type",align:"left",sortable:!0},{name:"Value",label:t("Value"),field:"Value",align:"left",sortable:!0},{name:"Descr",label:t("Descr"),field:"Descr",align:"left",sortable:!0},{name:"Editor",label:t("Editor"),field:"Editor",align:"left",sortable:!0},{name:"Cdt",label:t("Cdt"),field:"Cdt",align:"left",sortable:!0},{name:"Udt",label:t("Udt"),field:"Udt",align:"left",sortable:!0},{name:"ETLVersion",label:t("ETLVersion"),field:"ETLVersion",align:"left",sortable:!0},{name:"HasETLRelation",label:t("HasETLRelation"),field:"HasETLRelation",align:"left",sortable:!0}]});function T(){r.rows=j}function E(n,a,e){h.Topic=n,h.Version=L,h.Descr=e,S.push(`/ETL/ETLDiagram/STAGE?topic=${n}&version=${L}`)}function Q(n){let e=t("MsgConfirmExport",["STAGE"]);D.create({component:V,componentProps:{title:t("Export"),titleClass:"bg-brown text-white",message:e}}).onOk(()=>{})}function I(n){let a=t("Topic")+": "+n,e=t("MsgConfirmDelete",[a]);D.create({component:V,componentProps:{title:t("Delete"),titleClass:"bg-negative text-white",message:e}}).onOk(()=>{})}const f=H(!1);function q(n,a,e){if(n==null&&(n=""),a){if(!e){let d=t("MsgPleaseSelect",[t("JsonFile")]);y(d);return}}else{let d=t("MsgPleaseSelect",[t("DataBaseName")]);y(d);return}K("ETLManager/ETLDiagram/ImportDiagram",n,a,e).then(d=>{f.value=!1,T();let $=`${t("Import")}${t("Success")}`;X($)}).catch(d=>{console.log(d)})}return(n,a)=>(c(),P(z,null,[l("div",le,[l("div",oe,[l("div",se,[s(v,null,{default:o(()=>[s(x,{class:"q-pa-none"},{default:o(()=>[s(W,{grid:"",dense:"",rows:r.rows,columns:r.columns,filter:r.filter,"rows-per-page-options":[0]},{"top-right":o(()=>[s(w,{onClick:a[0]||(a[0]=e=>f.value=!0),label:m(t)("Import"),rounded:"",push:"",color:"positive",class:"q-ml-xs",style:{width:"100px"}},null,8,["label"]),s(G,{class:"q-pl-md",clearable:"",dense:"",debounce:"300",modelValue:r.filter,"onUpdate:modelValue":a[1]||(a[1]=e=>r.filter=e),placeholder:"Search"},{append:o(()=>[s(O,{name:"search"})]),_:1},8,["modelValue"])]),item:o(e=>[l("div",ae,[s(v,{class:"no-shadow",bordered:"",style:{"max-height":"115px"}},{default:o(()=>[s(x,{onClick:g=>E(e.row.Value,e.row.ETLVersion,e.row.Descr),class:"q-pb-none q-pt-sm cursor-pointer"},{default:o(()=>[e.row.HasETLRelation?b("",!0):(c(),_(Y,{key:0,floating:"",color:"pink-13"},{default:o(()=>a[3]||(a[3]=[p("New",-1)])),_:1,__:[3]})),l("div",ne,[l("div",ie,[l("div",re,[p(i(e.row.Value)+" ",1),e.row.Value.length>25?(c(),_(u,{key:0,class:"text-body2",anchor:"bottom middle",self:"top middle"},{default:o(()=>[l("strong",null,i(e.row.Value),1)]),_:2},1024)):b("",!0)]),l("div",de,[p(i(e.row.Descr)+" ",1),e.row.Descr.length>20?(c(),_(u,{key:0,class:"text-body2",anchor:"bottom middle",self:"top middle"},{default:o(()=>[l("strong",null,i(e.row.Descr),1)]),_:2},1024)):b("",!0)])]),l("div",ce,[s(U,{size:"lg",class:"bordered-avatar"},{default:o(()=>[p(i(e.row.ETLVersion),1)]),_:2},1024)])])]),_:2},1032,["onClick"]),s(F,{class:"row items-center justify-between q-pt-none"},{default:o(()=>[l("div",me,[s(w,{onClick:g=>E(e.row.Value,e.row.ETLVersion,e.row.Descr),icon:"edit",size:"md",round:"",flat:"",dense:"",class:"bg-secondary text-white"},{default:o(()=>[s(u,{class:"bg-secondary text-body2",anchor:"bottom middle",self:"top middle"},{default:o(()=>[l("strong",null,i(m(t)("Edit")),1)]),_:1})]),_:2},1032,["onClick"]),e.row.ETLVersion==_e?(c(),_(w,{key:0,onClick:g=>Q(e.row.Value),icon:"sym_o_file_copy",size:"md",round:"",flat:"",dense:"",class:"bg-brown text-white"},{default:o(()=>[s(u,{class:"bg-brown text-body2",anchor:"bottom middle",self:"top middle"},{default:o(()=>[l("strong",null,i(m(t)("ExportToStage")),1)]),_:1})]),_:2},1032,["onClick"])):b("",!0),s(w,{onClick:g=>I(e.row.Value),icon:"delete",size:"md",round:"",flat:"",dense:"",class:"bg-negative text-white"},{default:o(()=>[s(u,{class:"bg-negative text-body2",anchor:"bottom middle",self:"top middle"},{default:o(()=>[l("strong",null,i(m(t)("Delete")),1)]),_:1})]),_:2},1032,["onClick"])]),l("div",ue,[l("div",fe,i(e.row.Editor),1),l("div",ge,i(`${m(J).formatDate(e.row.Udt,"YYYY/MM/DD HH:mm:ss")}`),1)])]),_:2},1024)]),_:2},1024)])]),_:1},8,["rows","columns","filter"])]),_:1})]),_:1})])])]),s(ee,{modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=e=>f.value=e),onJsonFile:q,isNewTopic:!0},null,8,["modelValue"])],64))}});typeof C=="function"&&C(k);const Le=te(k,[["__scopeId","data-v-07e1da13"]]);export{Le as default};
